from Cryptodome.Cipher import AES
from Cryptodome.Util.Padding import unpad
import os

def decrypt(file_path, password):
    # Read the file
    with open(file_path, "rb") as f:
        encrypted_file = f.read()

    # Extract the IV and the ciphertext from the file
    iv = encrypted_file[:16]
    ciphertext = encrypted_file[16:]

    # Create the AES key from the password
    key = password.encode('utf-8')

    # Create a cipher object and decrypt the data
    cipher = AES.new(key, AES.MODE_CBC, iv=iv)
    decrypted_data = unpad(cipher.decrypt(ciphertext), AES.block_size)

    # Write the decrypted data to a file
    with open("decrypted.jpg", "wb") as f:
        f.write(decrypted_data)

# Use the function
decrypt('encrypted', 'you win this ctf')
